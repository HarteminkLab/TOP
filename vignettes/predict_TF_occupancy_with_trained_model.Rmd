---
title: 'Predict TF occupancy using trained TOP model'
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Predict TF occupancy using trained TOP model}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = '#>'
)
```

Install TOP R package
---------------------
```{r install-TOP-package, eval = FALSE}
install.packages("devtools")
library(devtools)
devtools::install_github("kevinlkx/TOP")
```

Load TOP R package
---------------------
```{r load-TOP-package, eval = FALSE}
library(TOP)
```

Input data
-----------
The input data should be a data frame, including six columns.

Columns from left to right should be PWM scores and 5 DNase (or ATAC) bins. 

You can follow this [page](./doc/preprocessing.html) to prepare the input data. 

Download pre-trained TOP models
--------------------------------
We will provide pre-trained models using ENCODE data 
[here](https://users.cs.duke.edu/~amink/software/).

Predict TF occupancy using trained TOP model
------------------------------------------------

Predict TF occupancy using trained TOP regression coefficients

```{r predict-TOP-mean-coef, eval = FALSE}
predictions <- predict_TOP(data, TOP_mean_coef, logistic.model = FALSE,
                           posterior.option = 'mean', transform = 'asinh')
```

<!-- Option 2: Predict TF occupancy using the posterior samples of  -->
<!-- regression coefficients trained from the TOP model -->

<!-- ```{r predict-TOP-samples, eval = FALSE} -->
<!-- predictions <- predict_TOP(data, TOP_samples, logistic.model = FALSE, -->
<!--                            posterior.option = 'samples', transform = 'asinh') -->
<!-- ``` -->

Predict TF binding probability using trained TOP logistic model
------------------------------------------------------------------

Predict TF binding probability using trained TOP logistic regression coefficients

```{r predict-TOP-logistic-mean-coef, eval = FALSE}
predictions <- predict_TOP(data, TOP_logistic_mean_coef, 
                           logistic.model = TRUE, posterior.option = 'mean')
```
